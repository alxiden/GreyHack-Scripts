metaxploit = include_lib("/lib/metaxploit.so")
cryptools = include_lib("/lib/crypto.so")

scanner = function(addr = null, port = 0)

results = {}

if addr == null then exit("Usage: hack [IP addr] [Port]")

ip_addr = addr
port = port

//Set the target
net_session = metaxploit.net_use(ip_addr,port)

//Connect to the target
if not net_session then exit("Error: Failed to connect!")

//Collects the libary
libarys = net_session.dump_lib

//Libary needed for the scan
metaLib = net_session.dump_lib

//Scans the Libary for exploits
print("------Scanning------")
scans = metaxploit.scan(metaLib)
for scan in scans
	memory = metaxploit.scan_address(metaLib,scan)
	//print(scan)
	//Isolate Keys
	key_strings = memory.split("Unsafe check: ")
	keys = [] 
	for key_string in key_strings
		if key_string == key_strings[0] then continue
		key = key_string[key_string.indexOf("<b>")+3:key_string.indexOf("</b>")]
		keys = keys + [key]
end for
results[scan] = keys
end for	

return(results)


exit("------Scan Complete ------")

end function 
