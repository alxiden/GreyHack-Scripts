cryptools = include_lib("/lib/crypto.so")
metaxploit = include_lib("/lib/metaxploit.so")

ip_address = params[0]

if params.len == 1 then
	port = null
	net_session = metaxploit.net_use(ip_address)
else
	port = params[1].to_int
	net_session = metaxploit.net_use(ip_address,port)
end if

//Connect to the target
if not net_session then exit("Error: Failed to connect!")

//Collects the libary
libarys = net_session.dump_lib

//Libary needed for the scan
metaLib = net_session.dump_lib

//Scans the Libary for exploits
print("------Scanning------")
scans = metaxploit.scan(metaLib)
for scan in scans
	memory = metaxploit.scan_address(metaLib,scan)
	print(scan + " " + memory)
end for	

exit("------Scan Complete ------")
